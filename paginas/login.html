<section class="pagina-conteudo login-page" data-aos="fade-up" id="Login" aria-labelledby="titulo-Login">
  <div class="login-box">
    <h2 id="titulo-Login">Login</h2>
    
    <div class="form-group">
      <label for="email"><i class="bi bi-envelope-fill"></i> E-mail</label>
      <input type="email" id="email" name="email" required placeholder="Digite seu e-mail">
    </div>

    <div class="form-group">
      <label for="senha"><i class="bi bi-lock-fill"></i> Senha</label>
      <input type="password" id="senha" name="senha" required placeholder="Digite sua senha">
    </div>

    <!-- ‚ö†Ô∏è ONCLICK DIRETO NO BOT√ÉO -->
    <button type="button" class="btn-login" onclick="fazerLogin()">Entrar</button>
    <div id="error-message" style="color: red; margin-top: 10px; text-align: center;"></div>

    <div class="login-links">
      <a href="#">Esqueceu a senha?</a>
      <a href="#">Criar uma conta</a>
    </div>
  </div>
</section>

<script>
console.log('‚úÖ Script de login carregado!');

// Fun√ß√£o global para o onclick
window.fazerLogin = async function() {
  console.log('üîÑ Fun√ß√£o fazerLogin() chamada!');
  
  const email = document.getElementById('email').value;
  const senha = document.getElementById('senha').value;
  const errorMessage = document.getElementById('error-message');
  const botao = event.target;
  
  if (!email || !senha) {
    errorMessage.textContent = 'Por favor, preencha email e senha';
    console.warn('‚ö†Ô∏è Campos vazios');
    return;
  }
  
  console.log('üìß Email:', email);
  
  botao.disabled = true;
  botao.textContent = 'Entrando...';
  errorMessage.textContent = '';
  
  try {
    console.log('üåê Enviando requisi√ß√£o para http://localhost:3000/auth/login');
    
    const response = await fetch('http://localhost:3000/auth/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, senha })
    });
    
    console.log('üì• Status da resposta:', response.status);
    
    const data = await response.json();
    console.log('üì¶ Dados recebidos:', data);
    
    if (response.ok) {
      console.log('‚úÖ Login bem-sucedido!');
      localStorage.setItem('token', data.token);
      localStorage.setItem('userName', data.nome);
      alert('Login realizado com sucesso!\nUsu√°rio: ' + data.nome);
      
      // Redireciona
      console.log('üîÄ Redirecionando para p√°gina de aulas...');
      window.location.hash = '#!paginas/atividades/aulas.html';
      setTimeout(() => location.reload(), 200);
      
    } else {
      console.error('‚ùå Erro:', data.error);
      errorMessage.textContent = data.error || 'Erro ao fazer login';
      botao.disabled = false;
      botao.textContent = 'Entrar';
    }
  } catch (error) {
    console.error('üí• Erro completo:', error);
    errorMessage.textContent = 'Erro ao conectar. Backend rodando na porta 3000?';
    botao.disabled = false;
    botao.textContent = 'Entrar';
  }
}

// Enter nos inputs
document.addEventListener('keypress', function(e) {
  if (e.key === 'Enter' && (e.target.id === 'email' || e.target.id === 'senha')) {
    e.preventDefault();
    fazerLogin();
  }
});

console.log('‚úÖ Sistema de login pronto!');
</script>
